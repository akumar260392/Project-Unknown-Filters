<!DOCTYPE html>
<html>
<head>
    <title>Project Unknown: Filter Suite</title>
    <style>
        body { font-family: sans-serif; text-align: center; background: #121212; color: white; }
        .container { margin-top: 50px; }
        img { max-width: 500px; margin-top: 20px; border: 2px solid #00ffcc; }
        button { background: #00ffcc; color: black; padding: 10px 20px; border: none; cursor: pointer; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Project Unknown Filter App</h1>
        <input type="file" id="imageInput"><br><br>
        <select id="filterSelect">
            <option value="vintagesepia">Vintage Sepia</option>
            <option value="noir">Noir (Grayscale)</option>
            <option value="nightvision">Night Vision</option>
        </select>
        <button onclick="applyFilter()">Apply Filter</button>
        <button onclick="resetFilter()">Reset</button>
        <br>
        <img id="resultImage" src="" style="display:none;">
    </div>

    <script>
        async function applyFilter() {
            const fileInput = document.getElementById('imageInput');
            const filter = document.getElementById('filterSelect').value;
            const resultImg = document.getElementById('resultImage');

            if (fileInput.files.length === 0) return alert("Please select a photo first!");

            const formData = new FormData();
            formData.append('file', fileInput.files[0]);

            // We send the filter name as a query parameter just like we tested in /docs
            const response = await fetch(`http://127.0.0.1:8000/filter?filtername=${filter}`, {
                method: 'POST',
                body: formData
            });

            const blob = await response.blob();
            resultImg.src = URL.createObjectURL(blob);
            resultImg.style.display = 'inline-block';
        }
        async function resetFilter() {
            // 1. Get the elements
            const fileInput = document.getElementById('imageInput');
            const filterSelect = document.getElementById('filterSelect');
            const resultImg = document.getElementById('resultImage');

            // 2. Clear the file picker
            fileInput.value = "";

            // 3. Reset the dropdown to the first option
            filterSelect.selectedIndex = 0; 

            // 4. Kill the image source and hide it
            resultImg.src = ""; 
            resultImg.style.display = 'none';
            
            console.log("App Reset Successful!");
        }
    </script>
</body>
</html>